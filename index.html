!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ATM Simulator - Bank of Code</title>
    <style>
      body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
      }
      .atm {
        background: #333;
        width: 400px;
        height: 600px;
        border-radius: 20px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
        padding: 20px;
        position: relative;
        color: white;
      }
      .screen {
        background: #000;
        color: #0f0;
        padding: 20px;
        height: 300px;
        overflow-y: auto;
        border-radius: 10px;
      }
      .buttons,
      .keypad {
        display: flex;
        flex-wrap: wrap;
        margin-top: 20px;
        gap: 10px;
      }
      button {
        flex: 1 0 30%;
        padding: 10px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        background-color: #555;
        color: white;
        cursor: pointer;
      }
      button:hover {
        background-color: #777;
      }
      .loan {
        position: absolute;
        bottom: 10px;
        right: 10px;
        background-color: #f90;
        color: black;
        padding: 5px 10px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="atm">
      <div class="screen" id="screen">Insert your card to begin.</div>
      <div class="keypad" id="keypad"></div>
      <div class="buttons" id="buttons"></div>
      <div class="loan" onclick="loanSection()">ðŸ’¸ Need a Loan?</div>
    </div>

    <script>
      let state = 'insert';
      let name = '';
      let pin = '';
      let balance = 1000;
      let loan = 0;
      let interest = 0;
      const screen = document.getElementById('screen');
      const keypad = document.getElementById('keypad');
      const buttons = document.getElementById('buttons');

      function showScreen(text) {
        screen.innerHTML = text;
      }

      function clearAll() {
        keypad.innerHTML = '';
        buttons.innerHTML = '';
      }

      function startATM() {
        state = 'getName';
        showScreen('Enter your name:');
        keypad.innerHTML =
          '<input id="nameInput" style="width: 100%; margin-top: 10px;"> <br><br>' +
          '<button onclick="submitName()">Submit</button>';
      }

      function submitName() {
        name = document.getElementById('nameInput').value;
        if (name === '') return;
        state = 'getPin';
        showScreen(`Welcome ${name}.\nEnter your 4-6 digit PIN:`);
        showKeypad();
      }

      function showKeypad() {
        clearAll();
        for (let i = 1; i <= 9; i++) {
          keypad.innerHTML += `<button onclick="enterPin('${i}')">${i}</button>`;
        }
        keypad.innerHTML += `<button onclick="enterPin('0')">0</button><button onclick="clearPin()">C</button><button onclick="submitPin()">OK</button>`;
      }

      function enterPin(num) {
        if (pin.length < 6) {
          pin += num;
          showScreen(`PIN: ${'*'.repeat(pin.length)}`);
        }
      }

      function clearPin() {
        pin = '';
        showScreen(`PIN: `);
      }

      function submitPin() {
        if (pin.length >= 4) {
          state = 'menu';
          showMenu();
        }
      }

      function showMenu() {
        clearAll();
        showScreen(
          `Welcome ${name}!\nBalance: â‚¹${balance.toFixed(
            2
          )}\nLoan: â‚¹${loan.toFixed(2)}\nChoose an option:`
        );
        ['Check Balance', 'Deposit', 'Withdraw', 'Eject'].forEach(
          (label, index) => {
            buttons.innerHTML += `<button onclick="menuAction('${label}')">${label}</button>`;
          }
        );
      }

      function menuAction(action) {
        if (action === 'Check Balance') {
          showScreen(
            `Your balance is â‚¹${balance.toFixed(2)}\nLoan: â‚¹${loan.toFixed(2)}`
          );
        } else if (action === 'Deposit') {
          let amt = prompt('Enter deposit amount:');
          if (!isNaN(amt) && amt > 0) {
            balance += parseFloat(amt);
            showScreen(`â‚¹${amt} deposited. New balance â‚¹${balance.toFixed(2)}`);
          }
        } else if (action === 'Withdraw') {
          let amt = prompt('Enter withdrawal amount:');
          if (!isNaN(amt) && amt > 0 && amt <= balance) {
            balance -= parseFloat(amt);
            showScreen(
              `â‚¹${amt} withdrawn. Remaining balance â‚¹${balance.toFixed(2)}`
            );
          } else {
            showScreen('Invalid or insufficient funds.');
          }
        } else if (action === 'Eject') {
          pin = '';
          state = 'insert';
          clearAll();
          showScreen('Card ejected. Thank you!');
        }
      }

      function loanSection() {
        const uname = prompt('Enter your full name:');
        const phone = prompt('Enter your phone number:');
        const amt = parseFloat(prompt('Loan amount you want:'));
        if (!isNaN(amt) && amt > 0) {
          const monthly = ((amt * 0.1) / 12).toFixed(2);
          balance += amt;
          loan += amt;
          showScreen(
            `Loan approved for â‚¹${amt}\nMonthly Interest: â‚¹${monthly}\nCredited to your account!`
          );
        }
      }

      // Start ATM simulation
      startATM();
    </script>
  </body>
</html>
